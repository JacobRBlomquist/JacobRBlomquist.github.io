<span class="foreground-8">  1 </span><span class="foreground-14">import</span><span class="foreground-15"> System                                                  </span>                <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8">  2 </span><span class="foreground-14">import</span><span class="foreground-15"> Foreign                                                 </span>                <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8">  3 </span><span class="foreground-14">import</span><span class="foreground-15"> </span><span class="foreground-14">qualified</span><span class="foreground-15"> Data.ByteString </span><span class="foreground-14">as</span><span class="foreground-15"> B                                          <span class="background-0">
</span></span><span class="foreground-8">  4 </span><span class="foreground-15">                                                                               <span class="background-0">
</span></span><span class="foreground-8">  5 </span><span class="foreground-15">main </span><span class="foreground-14">=</span><span class="foreground-15"> </span><span class="foreground-12">do</span><span class="foreground-15">                                                                      <span class="background-0"> </span>
</span><span class="foreground-8">  6 </span><span class="foreground-15">    w </span><span class="foreground-14">&lt;-</span><span class="foreground-15"> getArgs </span><span class="foreground-14">&gt;&gt;=</span><span class="foreground-15"> readIO </span><span class="foreground-14">.</span><span class="foreground-15"> head                                             <span class="background-0"> </span>
</span><span class="foreground-8">  7 </span><span class="foreground-15">    </span><span class="foreground-12">let</span><span class="foreground-15"> n      </span><span class="foreground-14">=</span><span class="foreground-15"> w </span><span class="foreground-14">`div`</span><span class="foreground-15"> </span><span class="foreground-9">8</span><span class="foreground-15">                                    </span>                 <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8">  8 </span><span class="foreground-15">        loop_y </span><span class="foreground-14">=</span><span class="foreground-15"> B.unfoldrN n (next_x w (</span><span class="foreground-9">2</span><span class="foreground-14">/</span><span class="foreground-15">fromIntegral w) n)                  <span class="background-0">
</span></span><span class="foreground-8">  9 </span><span class="foreground-15">                  </span>             <span class="foreground-15">                       </span>                         <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 10 </span><span class="foreground-15">        unfold x </span><span class="foreground-14">=</span><span class="foreground-15"> </span><span class="foreground-12">case</span><span class="foreground-15"> loop_y x </span><span class="foreground-12">of</span><span class="foreground-15">                                    </span>        <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 11 </span><span class="foreground-15">                    (s, Nothing) </span><span class="foreground-14">-&gt;</span><span class="foreground-15"> B.putStr s                                 <span class="background-0"> </span>
</span><span class="foreground-8"> 12 </span><span class="foreground-15">                    (s, Just x)  </span><span class="foreground-14">-&gt;</span><span class="foreground-15"> B.putStr s </span><span class="foreground-14">&gt;&gt;</span><span class="foreground-15"> unfold x                     <span class="background-0"> </span>
</span><span class="foreground-8"> 13 </span><span class="foreground-15">                                                                   </span>            <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 14 </span><span class="foreground-15">    putStrLn (</span><span class="foreground-10">&quot;P4\n&quot;</span><span class="foreground-14">++</span><span class="foreground-15">show w</span><span class="foreground-14">++</span><span class="foreground-10">&quot; &quot;</span><span class="foreground-14">++</span><span class="foreground-15">show w)                                     <span class="background-0">
</span></span><span class="foreground-8"> 15 </span><span class="foreground-15">    unfold (T </span><span class="foreground-9">1</span><span class="foreground-15"> </span><span class="foreground-9">0</span><span class="foreground-15"> </span><span class="foreground-9">0</span><span class="foreground-15"> (</span><span class="foreground-14">-</span><span class="foreground-9">1</span><span class="foreground-15">))                                           </span>           <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 16 </span><span class="foreground-15">                                                                               <span class="background-0"> </span>
</span><span class="foreground-8"> 17 </span><span class="foreground-14">data</span><span class="foreground-15"> T </span><span class="foreground-14">=</span><span class="foreground-15"> T </span><span class="foreground-14">!</span><span class="foreground-15">Int </span><span class="foreground-14">!</span><span class="foreground-15">Int </span><span class="foreground-14">!</span><span class="foreground-15">Int </span><span class="foreground-14">!</span><span class="foreground-15">Double                                    </span>          <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 18 </span><span class="foreground-15">                                                                               <span class="background-0"> </span>
</span><span class="foreground-8"> 19 </span><span class="foreground-15">next_x </span><span class="foreground-14">!</span><span class="foreground-15">w </span><span class="foreground-14">!</span><span class="foreground-15">iw </span><span class="foreground-14">!</span><span class="foreground-15">bw (T bx x y ci)                                    </span>            <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 20 </span><span class="foreground-15">    </span><span class="foreground-14">|</span><span class="foreground-15"> y  </span><span class="foreground-14">==</span><span class="foreground-15"> w   </span><span class="foreground-14">=</span><span class="foreground-15"> Nothing                                                      <span class="background-0"> </span>
</span><span class="foreground-8"> 21 </span><span class="foreground-15">    </span><span class="foreground-14">|</span><span class="foreground-15"> bx </span><span class="foreground-14">==</span><span class="foreground-15"> bw  </span><span class="foreground-14">=</span><span class="foreground-15"> Just (loop_x w x </span><span class="foreground-9">8</span><span class="foreground-15"> iw ci </span><span class="foreground-9">0</span><span class="foreground-15">, T </span><span class="foreground-9">1</span><span class="foreground-15"> </span><span class="foreground-9">0</span><span class="foreground-15">    (y</span><span class="foreground-14">+</span><span class="foreground-9">1</span><span class="foreground-15">)   (iw</span><span class="foreground-14">+</span><span class="foreground-15">ci))        <span class="background-0">
</span></span><span class="foreground-8"> 22 </span><span class="foreground-15">    </span><span class="foreground-14">|</span><span class="foreground-15"> otherwise </span><span class="foreground-14">=</span><span class="foreground-15"> Just (loop_x w x </span><span class="foreground-9">8</span><span class="foreground-15"> iw ci </span><span class="foreground-9">0</span><span class="foreground-15">, T (bx</span><span class="foreground-14">+</span><span class="foreground-9">1</span><span class="foreground-15">) (x</span><span class="foreground-14">+</span><span class="foreground-9">8</span><span class="foreground-15">) y ci)</span>             <span class="background-0"><span class="foreground-15">
</span></span><span class="foreground-8"> 23 </span><span class="foreground-15">                                                                               <span class="background-0">
</span></span><span class="foreground-8"> 24 </span><span class="foreground-15">loop_x </span><span class="foreground-14">!</span><span class="foreground-15">w </span><span class="foreground-14">!</span><span class="foreground-15">x </span><span class="foreground-14">!</span><span class="foreground-15">n </span><span class="foreground-14">!</span><span class="foreground-15">iw </span><span class="foreground-14">!</span><span class="foreground-15">ci </span><span class="foreground-14">!</span><span class="foreground-15">b                                                     <span class="background-0"> </span>
</span><span class="foreground-8"> 25 </span><span class="foreground-15">    </span><span class="foreground-14">|</span><span class="foreground-15"> x </span><span class="foreground-14">&lt;</span><span class="foreground-15"> w </span><span class="foreground-14">=</span><span class="foreground-15"> </span><span class="foreground-12">if</span><span class="foreground-15"> n </span><span class="foreground-14">==</span><span class="foreground-15"> </span><span class="foreground-9">0</span><span class="foreground-15">                                                        <span class="background-0"> </span>
</span><span class="foreground-8"> 26 </span><span class="foreground-15">                    </span><span class="foreground-12">then</span><span class="foreground-15"> b                                                     <span class="background-0"> </span>
</span><span class="foreground-8"> 27 </span><span class="foreground-15">                    </span><span class="foreground-12">else</span><span class="foreground-15"> loop_x w (x</span><span class="foreground-14">+</span><span class="foreground-9">1</span><span class="foreground-15">) (n</span><span class="foreground-14">-</span><span class="foreground-9">1</span><span class="foreground-15">) iw ci (b</span><span class="foreground-14">+</span><span class="foreground-15">b</span><span class="foreground-14">+</span><span class="foreground-15">v)                    <span class="background-0"> </span>
</span><span class="foreground-8"> 28 </span><span class="foreground-15">    </span><span class="foreground-14">|</span><span class="foreground-15"> otherwise </span><span class="foreground-14">=</span><span class="foreground-15"> b </span><span class="foreground-14">`shiftL`</span><span class="foreground-15"> n                                                 <span class="background-0"> </span>
</span><span class="foreground-8"> 29 </span><span class="foreground-15">  </span><span class="foreground-14">where</span><span class="foreground-15">                                                                        <span class="background-0">
</span></span><span class="foreground-8"> 30 </span><span class="foreground-15">    v </span><span class="foreground-14">=</span><span class="foreground-15"> fractal </span><span class="foreground-9">0</span><span class="foreground-15"> </span><span class="foreground-9">0</span><span class="foreground-15"> (fromIntegral x </span><span class="foreground-14">*</span><span class="foreground-15"> iw </span><span class="foreground-14">-</span><span class="foreground-15"> </span><span class="foreground-9">1.5</span><span class="foreground-15">) ci </span><span class="foreground-9">50</span><span class="foreground-15">                          <span class="background-0"> </span>
</span><span class="foreground-8">~
~
</span><span class="background-0"><span class="foreground-15">haskell.hs                                                                            1,1            All
</span></span><span class="foreground-15">:VimFilerExplorer
